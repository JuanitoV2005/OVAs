<!-- Tipos de datos enteros en Java -->
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Primitivos en Java</title>
    <link rel="stylesheet" href="../assets/css/global/principal.css">
    <link rel="stylesheet" href="../assets/css/global/niveles.css">
    <link rel="stylesheet" href="../assets/css/pag3/cartas-resumen.css">

    <script src="https://cdn.jsdelivr.net/npm/p5@1.4.2/lib/p5.min.js"></script>
    <script src="../assets/js/global/conversionBinario.js"></script>
    <script src="../assets/js/global/chessboard.js"></script>
    <script src="../assets/js/pag3/funcionesQuiz.js"></script>
</head>

<body>
    <main>
        <h1>Tipos de Datos Enteros en Java</h1>

        <h2>Introducci√≥n</h2>

        <p>
            Para un uso pr√°ctico eficiente de los tipos de datos enteros en Java,
            es indispensable tener presente el rango y el tama√±o de cada uno.
            Conocer las capacidades de byte, short, int y long te permitir√° seleccionar el tipo m√°s apropiado para tus
            variables,
            optimizando as√≠ el consumo de memoria y evitando posibles desbordamientos de datos que podr√≠an causar
            errores en tu programa.
        </p>

        <h2>Resumen</h2>
        <p>
            Observa con atenci√≥n los rangos mostrados en la tabla. ¬øNotas alg√∫n patr√≥n?
            Ahora intenta aplicar la f√≥rmula que vimos para el complemento a 2:
            <strong><code>‚Äì2^(n-1) a 2^(n-1) ‚Äì 1</code></strong> seg√∫n el n√∫mero de bits de cada tipo.
            ¬øCoinciden los resultados? Comprueba que la f√≥rmula realmente explica por qu√© un <code>byte</code> llega
            hasta 127,
            o por qu√© un <code>long</code> puede representar n√∫meros tan negativos.
        </p>

        <section class="card-grid">
            <!-- BYTE -->
            <div class="card-teoria">
                <div class="card-bar red"></div>
                <div class="card-body">
                    <div class="card-header">
                        <h2>byte</h2>
                        <span class="badge">8 bits</span>
                    </div>
                    <p>El tipo m√°s peque√±o, ideal para ahorrar memoria en arrays grandes</p>
                    <div class="card-info">
                        <p><strong>Tama√±o:</strong> 1 byte</p>
                        <progress value="12.5" max="100"></progress>
                        <small>8 bits de 64</small>
                    </div>
                    <div class="card-range">
                        <strong>Rango de valores:</strong>
                        <div class="range-box">
                            <div>M√≠nimo: -128</div>
                            <div>M√°ximo: 127</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SHORT -->
            <div class="card-teoria">
                <div class="card-bar orange"></div>
                <div class="card-body">
                    <div class="card-header">
                        <h2>short</h2>
                        <span class="badge">16 bits</span>
                    </div>
                    <p>√ötil cuando necesitas m√°s rango que byte pero menos que int</p>
                    <div class="card-info">
                        <p><strong>Tama√±o:</strong> 2 bytes</p>
                        <progress value="25" max="100"></progress>
                        <small>16 bits de 64</small>
                    </div>
                    <div class="card-range">
                        <strong>Rango de valores:</strong>
                        <div class="range-box">
                            <div>M√≠nimo: -32.768</div>
                            <div>M√°ximo: 32.767</div>
                        </div>
                    </div>
                    <!-- <div class="example">
                <strong>Ejemplo:</strong>
                <code>short a√±o = 2024;</code>
            </div> -->
                </div>
            </div>

            <!-- INT -->
            <div class="card-teoria">
                <div class="card-bar blue"></div>
                <div class="card-body">
                    <div class="card-header">
                        <h2>int</h2>
                        <span class="badge">32 bits</span>
                    </div>
                    <p>El tipo entero m√°s com√∫n, usado por defecto para n√∫meros enteros</p>
                    <div class="card-info">
                        <p><strong>Tama√±o:</strong> 4 bytes</p>
                        <progress value="50" max="100"></progress>
                        <small>32 bits de 64</small>
                    </div>
                    <div class="card-range">
                        <strong>Rango de valores:</strong>
                        <div class="range-box">
                            <div>M√≠nimo: -2.147.483.648</div>
                            <div>M√°ximo: 2.147.483.647</div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- LONG -->
            <div class="card-teoria">
                <div class="card-bar green"></div>
                <div class="card-body">
                    <div class="card-header">
                        <h2>long</h2>
                        <span class="badge">64 bits</span>
                    </div>
                    <p>Para n√∫meros muy grandes, requiere sufijo 'L' (may√∫scula para evitar ambiguedades).</p>
                    <div class="card-info">
                        <p><strong>Tama√±o:</strong> 8 bytes</p>
                        <progress value="100" max="100"></progress>
                        <small>64 bits de 64</small>
                    </div>
                    <div class="card-range">
                        <strong>Rango de valores:</strong>
                        <div class="range-box">
                            <div>M√≠nimo: -9.223.372.036.854.775.808</div>
                            <div>M√°ximo: 9.223.372.036.854.775.807</div>
                        </div>
                    </div>

                </div>
            </div>
        </section>


        <br>
        <h2>Actividad</h2>


        <script>
            // Llama a la funci√≥n para cada quiz en DOMContentLoaded
            window.addEventListener("DOMContentLoaded", () => {
                inicializarQuizInputs("quiz1", "enteros_q1_");
                inicializarQuizInputs("quiz2", "enteros_q2_");
            });

            // Llama a la funci√≥n para cada quiz en window.onload
            window.addEventListener("load", () => {
                restaurarQuiz("quiz1", respuestasQ1, "resultadoFormulario", "botonValidarQ1", "enteros_q1_");
                restaurarQuiz("quiz2", respuestasQ2, "resultadoFormularioQ2", "botonValidarQ2", "enteros_q2_");
            });

        </script>
        <div class="chessboard-quiz">
            <div class="chessboard-canvas" id="chessboardQuiz1" style="max-width: 400px;""></div>

                <form class=" quiz-form" id="quiz1">
                <label>
                    1. ¬øCu√°nto es 2 + 2?
                    <input type="text" name="q1">
                </label>

                <label>
                    2. ¬øCu√°nto es 5 √ó 3?
                    <input type="text" name="q2">
                </label>

                <fieldset>
                    <legend>3. ¬øCu√°l de estos es un tipo entero en Java?</legend>
                    <label class="checkbox"><input type="radio" name="q1-multi" value="short"> short</label><br>
                    <label class="checkbox"><input type="radio" name="q1-multi" value="int"> int</label><br>
                    <label class="checkbox"><input type="radio" name="q1-multi" value="byte"> byte</label>
                </fieldset>



                <label class="cadenaEnteraBinaria">
                    4. Ingresa el n√∫mero 5 en binario (16 bits, complemento a 2):
                    <input type="text" name="q3" placeholder="0000000000000000" readonly>
                    <div class="decimal-output" id="decimal-q3"></div>
                </label>

                <label class="cadenaEnteraBinaria">
                    5. Ingresa el n√∫mero -3 en binario (8 bits, complemento a 2):
                    <input type="text" name="q4" placeholder="00000000" readonly>
                    <div class="decimal-output" id="decimal-q4"></div>
                </label>

                <div class="buttons">
                    <button type="button" id="botonValidarQ1" class="verifyBtn"
                        onclick="validarFormularioChessboard(respuestasQ1,'quiz1','resultadoFormulario','botonValidarQ1','enteros_q1_')">Validar
                        respuestas</button>
                </div>


                <p id="resultadoFormulario"></p>
                </form>

            </div>

            <a href="pag2.html">Ir a la p√°gina 2</a>
            <script>
                const respuestasQ1 = {
                    q1: { valor: "4" },
                    q2: { valor: "15" },
                    "q1-multi": { valor: "int" },  // üîπ nueva respuesta correcta
                    q3: { valor: "5", filas: [8, 7] },
                    q4: { valor: "-3", filas: [6] }
                };


                // Funci√≥n del canvas
                function sketchQuiz1(p) {
                    // -------- Creacion del canvas ---------
                    let gui = {
                        "background": "#ffffff",
                        "cellColor1": "#b58863",
                        "cellColor2": "#f0d9b5",
                        "cellLength": 50,
                    }

                    const tableroVacio = Array(8).fill().map(() => Array(8).fill(null))

                    // Colores disponibles de piezas y sus c√≥digos
                    const pawnCodes = ['pw', 'pg', 'pr', 'pb', 'pk'];
                    const pieceImages = {};

                    // Crear tablero
                    const rows = 8, cols = 8;
                    const pieces = Array.from({ length: rows }, () => Array(cols).fill(null));
                    const assignedMap = [
                        ['pg', 'pw', 'pw', 'pw', 'pw', 'pw', 'pw', 'pw'],
                        ['pw', 'pw', 'pw', 'pw', 'pw', 'pw', 'pw', 'pw'],
                        ['pr', 'pk', 'pk', 'pk', 'pk', 'pk', 'pk', 'pk'],
                        [null, null, null, null, null, null, null, null],
                        [null, null, null, null, null, null, null, null],
                        [null, null, null, null, null, null, null, null],
                        [null, null, null, null, null, null, null, 'pk']
                    ];

                    // Al cargar, restaurar pieces desde localStorage si existe y no est√° validado
                    const piecesGuardadas = localStorage.getItem("enteros_q1_pieces");
                    const validado = localStorage.getItem("enteros_q1_validado") === "true";
                    if (piecesGuardadas && !validado) {
                        try {
                            const restored = JSON.parse(piecesGuardadas);
                            if (Array.isArray(restored) && restored.length === rows) {
                                pieces = restored;
                            }
                        } catch (e) {
                            // Si falla, ignora y usa el tablero vac√≠o
                        }
                    }


                    tablero1 = new ChessBoard(
                        p,
                        [gui.cellColor1, gui.cellColor2],
                        [20, 20],
                        gui.cellLength,
                        [rows, cols],
                        pieces,
                        pieceImages // sin im√°genes por ahora
                    );

                    tablero1.assignedCodeMap = assignedMap;

                    // --------- L√≥gica de interacci√≥n ---------
                    p.setup = function () {
                        const canvas = p.createCanvas(gui.cellLength * 8 + 50, gui.cellLength * 8 + 40);
                    }
                    p.draw = function () {
                        // Restaurar pieces desde localStorage si existe y no est√° validado
                        const piecesGuardadas = localStorage.getItem("enteros_q1_pieces");
                        const validado = localStorage.getItem("enteros_q1_validado") === "true";
                        if (piecesGuardadas && !validado) {
                            try {
                                const restored = JSON.parse(piecesGuardadas);
                                if (Array.isArray(restored) && restored.length === rows) {
                                    tablero1.pieces = restored;
                                }
                            } catch (e) {
                                // Si falla, ignora
                            }
                        }

                        tablero1.draw();
                    };


                    p.mousePressed = function () {
                        const validado = localStorage.getItem("enteros_q1_validado") === "true";
                        if (validado) {
                            return;
                        }

                        clicked = tablero1.mousePressed();
                        if (!clicked) {
                            return;
                        }

                        // Guardar el estado actual de pieces en localStorage
                        localStorage.setItem("enteros_q1_pieces", JSON.stringify(tablero1.pieces));

                        // Diccionario para guardar respuestas
                        let respuestasGuardadas = JSON.parse(localStorage.getItem("enteros_q1_respuestas") || "{}");

                        let decimalesGuardados = JSON.parse(localStorage.getItem("enteros_q1_decimales") || "{}");

                        // Recorrer todas las preguntas y actualizar el input y el decimal si tiene filas
                        for (let key in respuestasQ1) {
                            const obj = respuestasQ1[key];
                            if (Array.isArray(obj.filas) && obj.filas.length > 0) {
                                const input = document.querySelector(`input[name="${key}"]`);
                                if (input) {
                                    const binStr = tablero1.getBinaryString(obj.filas);
                                    input.value = binStr;
                                    respuestasGuardadas[key] = binStr;

                                    // Actualiza el decimal debajo del input si existe
                                    const decimalDiv = document.getElementById("decimal-" + key);
                                    if (decimalDiv) {
                                        let decimalText;
                                        try {
                                            decimalText = "Decimal: " + binarioAEntero(binStr);
                                        } catch {
                                            decimalText = "Decimal: (inv√°lido)";
                                        }
                                        decimalDiv.textContent = decimalText;
                                        decimalesGuardados[key] = decimalText;
                                    }
                                }
                            }
                        }

                        // Guardar todas las respuestas en localStorage bajo el prefijo
                        localStorage.setItem("enteros_q1_respuestas", JSON.stringify(respuestasGuardadas));
                        localStorage.setItem("enteros_q1_decimales", JSON.stringify(decimalesGuardados));
                    };

                };

                // Iniciar el sketch de p5
                new p5(sketchQuiz1, 'chessboardQuiz1');
            </script>




            <h1>Segundo quiz</h1>
            <p>Otro ejemplo.</p>
            <div class="canvas-quiz">
                <div id="chessboardQuiz2"></div>
                <script>
                    const respuestasQ2 = {
                        "q2-q1": { valor: "4" },
                        "q2-q2": { valor: "15" },
                        "q2-q3": { valor: "5", filas: [8, 7] },
                        "q2-q4": { valor: "-3", filas: [6] }
                    };
                </script>
                <form id="quiz2">
                    <label>
                        1. ¬øCu√°nto es 2 + 2?
                        <input type="text" name="q2-q1">
                    </label>

                    <label>
                        2. ¬øCu√°nto es 5 √ó 3?
                        <input type="text" name="q2-q2">
                    </label>

                    <label class="cadenaEnteraBinaria">
                        3. Ingresa el n√∫mero 5 en binario (16 bits, complemento a 2):
                        <input type="text" name="q2-q3" placeholder="0000000000000000" readonly>
                    </label>

                    <label class="cadenaEnteraBinaria">
                        4. Ingresa el n√∫mero -3 en binario (8 bits, complemento a 2):
                        <input type="text" name="q2-q4" placeholder="00000000" readonly>
                    </label>

                    <button type="button" id="botonValidarQ2" class="verifyBtn"
                        onclick="validarFormularioChessboard(respuestasQ2,'quiz2','resultadoFormularioQ2','botonValidarQ2','enteros_q2_')">Validar
                        respuestas</button>
                    <p id="resultadoFormularioQ2"></p>
                </form>
            </div>








            <br>



            <div class="footer-fixed">
                <div class="buttons">
                    <button id="previousBtn" onclick="window.location.href='pag2.html';">Anterior</button>
                    <button id="nextBtn" onclick="window.location.href='pag3.html';">Siguiente</button>
                </div>


                <div class="level-counter" id="levelIndicator">3 / ?</div>
            </div>

    </main>
</body>

</html>